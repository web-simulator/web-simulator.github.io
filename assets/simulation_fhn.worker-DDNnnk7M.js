(function(){"use strict";self.onmessage=N=>{const T=N.data;let{k:x,A:b,alpha:j,epsilon:q,gamma:z,L:B,dx:c,dt:e,totalTime:E,downsamplingFactor:G,initialCondition:H}=T;const F=c*c/(2*x);e>F&&(e=F*.9);const o=Math.floor(B/c);let s=new Array(o).fill(0),a=new Array(o).fill(0);if(H==="reentry"){const l=Math.floor(o/2);for(let n=l-2;n<l+2;n++)s[n]=1.05;for(let n=0;n<Math.floor(.9*l);n++)a[n]=1}else{const l=Math.floor(o/10);for(let n=0;n<l;n++)s[n]=1.05}const I=Math.floor(E/e),C=[];for(let l=0;l<I;l++){let n=function(t,f,r){const J=r===0?t[o-1]:t[r-1],K=r===o-1?t[0]:t[r+1],O=x*(K-2*t[r]+J)/(c*c),P=b*t[r]*(1-t[r])*(t[r]-j);return O+P-f[r]},i=function(t,f,r){return q*(t[r]-z*f[r])};const w=new Array(o),_=new Array(o),k=new Array(o),m=new Array(o),p=new Array(o),y=new Array(o),D=new Array(o),L=new Array(o);for(let t=0;t<o;t++)w[t]=e*n(s,a,t),_[t]=e*i(s,a,t);const A=[...s],d=[...a];for(let t=0;t<o;t++)A[t]=s[t]+.5*w[t],d[t]=a[t]+.5*_[t];for(let t=0;t<o;t++)k[t]=e*n(A,d,t),m[t]=e*i(A,d,t);const h=[...s],u=[...a];for(let t=0;t<o;t++)h[t]=s[t]+.5*k[t],u[t]=a[t]+.5*m[t];for(let t=0;t<o;t++)p[t]=e*n(h,u,t),y[t]=e*i(h,u,t);const M=[...s],g=[...a];for(let t=0;t<o;t++)M[t]=s[t]+p[t],g[t]=a[t]+y[t];for(let t=0;t<o;t++)D[t]=e*n(M,g,t),L[t]=e*i(M,g,t);for(let t=0;t<o;t++)s[t]=s[t]+1/6*(w[t]+2*k[t]+2*p[t]+D[t]),a[t]=a[t]+1/6*(_[t]+2*m[t]+2*y[t]+L[t]);if(l%G===0){const t=s.map((f,r)=>({x:r*c,v:f,w:a[r],tempo:(l*e).toFixed(2)}));C.push({time:(l*e).toFixed(2),data:t})}}self.postMessage(C)}})();
